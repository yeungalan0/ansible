# {{ ansible_managed }}

{
	pki {
		ca local {
			install_trust false
		}
	}
}

# Pi-hole — Tailscale HTTPS (auto cert from tailscaled)
{{ pi_ts_hostname }} {
	tls {
		get_certificate tailscale
	}
	reverse_proxy 127.0.0.1:{{ pihole_web_port }}
}

# Actual Budget — Tailscale HTTPS (auto cert from tailscaled)
{{ pi_ts_hostname }}:{{ actual_port }} {
	tls {
		get_certificate tailscale
	}
	reverse_proxy 127.0.0.1:{{ actual_internal_port }}
}

# Pi-hole — LAN IP access (self-signed cert)
:443 {
	tls internal
	reverse_proxy 127.0.0.1:{{ pihole_web_port }}
}

# Actual Budget — LAN IP access (self-signed cert)
:{{ actual_port }} {
	tls internal
	reverse_proxy 127.0.0.1:{{ actual_internal_port }}
}
